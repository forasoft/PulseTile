<!--
  ~  Copyright 2016 Ripple Foundation C.I.C. Ltd
  ~  
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~  
  ~    http://www.apache.org/licenses/LICENSE-2.0

  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->
<header class="">
  <!-- New Mobile Navbar -->
  <nav class="navbar navbar-default header-nav visible-xs">
    <div class="container-fluid">
      <div class="navbar-header">
        <a ng-if="title" class="navbar-brand header-title-mobile" ng-click="$ctrl.goHome()">
          <img class="header-icon nav-logo" alt="{{title}}"> {{title}}
        </a>

        <ul class="nav nav-tabs pull-right" role="tablist">
          <li ng-class="$ctrl.activeNavTab('notifications')"><a ng-click="$ctrl.changeNavTab('notifications')">
            <i class="fa fa-bell-o"><span class="count">2</span></i></a>
          </li>
          <li ng-class="$ctrl.activeNavTab('user')"><a ng-click="$ctrl.changeNavTab('user')">
            <i class="fa fa-user"></i></a>
          </li>
          <li ng-class="$ctrl.activeNavTab('search')"><a ng-click="$ctrl.changeNavTab('search')">
            <i class="fa fa-search"></i></a>
          </li>
        </ul>
      </div>

      <!-- Tab panes -->
      <div class="tab-content" ng-switch="currentNavTab">

        <!-- Notification -->
        <div ng-if="$ctrl.currentNavTab==='notifications'" class="pane row" id="tab-notifications">
          <div class="notifications-header">
            Notifications (2)
          </div>
          <div class="notifications-body">
            <ul>
              <li>
                <div class="notification-info">Information from Liquid Logic (Social Care) is currently unavailable.</div>
                <div class="notification-time">5 minutes ago</div>
              </li>
              <li>
                <div class="notification-info">Information from Liquid Logic (Social Care) is currently unavailable.</div>
                <div class="notification-time">5 minutes ago</div>
              </li>
            </ul>
          </div>
        </div>
        <!-- /.Notification -->

        <!-- User Profile -->
        <div ng-if="$ctrl.currentNavTab==='user'" class="pane row" id="tab-user">
          <div class="col-xs-12">

            <div class="user-type superuser">Super User</div>
            <!--<div class="user-type clinician">Clinician</div>-->
            <!--<div class="user-type patient">Patient</div>-->

            <div class="user-profile-image"><i class="fa fa-user"></i></div>
            <p class="header-title-mobile"><strong>User Name:</strong>{{user.role}}</p>
            <p>{{user.email}}</p>
            <p>10/05/2099</p>
          </div>
          <div class="col-xs-12 options">
            <ul>
              <li><a href="" class="btn">Settings</a></li>
              <li><a href="" class="btn">Admin Console</a></li>
            </ul>
            <ul>
              <li><a href="https://ripple-identity-uat.answerappcloud.com/signout" class="signout btn">SIGN OUT  <i class="fa fa-sign-out"></i></a></li>
            </ul>
          </div>
        </div>
        <!-- /.User Profile -->

        <!-- Mobile Nav Search -->
        <div ng-if="$ctrl.currentNavTab==='search'" class="pane row" id="tab-search">

          <div id="mobile-nav-search">
            <div class="col-xs-12 header-search-mobile">

              <button class="btn btn-info" ng-click="$ctrl.searchFunction();"><i class="fa fa-search"></i></button>

              <div class="search-left-inner-addon">
                <div ng-show="$root.reportMode" class="ng-cloak" ng-cloak><span ng-cloak ng-show="$root.reportMode" class="label ng-cloak report-label">Reports&nbsp;<i ng-show="$root.reportMode" ng-click="$ctrl.cancelSearchMode()" class="fa fa-times"></i></span></div>
                <i ng-show="search.searchExpression !== '' || $root.searchMode" ng-click="$ctrl.cancelSearchMode()" class="clearAll fa fa-times-circle"></i>
                <div class="search-left-inner-addon">
                  <div ng-show="$root.searchMode" class="ng-cloak" ng-cloak>
                    <span ng-cloak class="label ng-cloak report-label">
                  <div ng-if="$root.reportMode">Reports&nbsp;</div>
                  <div ng-if="$root.settingsMode">Setting&nbsp;</div>
                  <div ng-if="$root.patientMode">Patients&nbsp;</div>
                  <i ng-click="$ctrl.cancelSearchMode()" class="fa fa-times"></i></span>
                  </div>
                  <div ng-show="$root.reportTypeSet" class="ng-cloak" ng-cloak>
                    <span ng-cloak class="label ng-cloak reportType-label">
                    <div class="reportTypeSet">
                      {{$root.reportTypeString}}&nbsp;
                      <i ng-click="$ctrl.cancelReportType()" class="fa cancel-reportType fa-times"></i>
                    </div>
                    </span>
                  </div>
                  <div></div>
                  <input key-bind="{ enter: '$ctrl.searchFunction()', esc: '$ctrl.cancelSearchMode()' }" class="form-control" placeholder="Search..." type="text" uib-typeahead="report for report in $ctrl.reportTypes | filter:$viewValue" ng-model="search.searchExpression" ng-keyup="$ctrl.checkExpression(search.searchExpression)" ng-trim="false" ng-class="{'moveRight': $root.searchMode && !$root.reportTypeSet, 'moveFurtherRight': $root.searchMode && $root.reportTypeSet}" focus-element="searchFocused"/>
                </div>
              </div>
            </div>

          </div>

        </div>
        <!-- /.Mobile Nav Search -->

      </div>
      <!-- /.Tab panes -->



    </div><!-- /.container-fluid -->
  </nav>
  <!-- /.New Mobile Navbar -->

  <!-- Header toolbar mobile -->
  <div class="row header-toolbar visible-xs">
    <div class="col-xs-2">
      <div class="innner">
        <span class="glyphicon glyphicon-arrow-left previous-page-arrow" ng-if="previousPage && currentUser.role=='idcr'" ng-click="goBack()"></span>
      </div>
    </div>
    <div class="col-xs-8 current-page-title-mobile">
      <div class="inner">
        <span>{{pageHeader}}</span>
      </div>
    </div>
    <div class="col-xs-2 text-right">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar-nav" aria-expanded="false" ng-if=(userContextViewExists)>
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
  </div>
  <div class="visible-xs mobile-sidebar navbar-default">
    <div class="collapse navbar-collapse sidebar" id="sidebar-nav">
      <ul side-menu class="nav" ui-view="actions"></ul>
    </div>
  </div>
  <!-- /.Header toolbar mobile-->

  <div class="row header-background hidden-xs">
    <div class="col-sm-4 header-left">
      <div class="glyphs g">
        <p class="header-title-1"><img alt="Ripple Icon" class="header-icon" ng-click="$ctrl.goHome()"> {{title}}</p>
      </div>
    </div>

    <div class="col-md-5 col-sm-8 hidden-xs header-search ng-cloak" ng-cloak ng-class="{'searchBarHidden' : !$ctrl.searchBarEnabled }">

      <div class="header-search-inner" ng-if="searchBar">

        <div class="search-left-inner-addon">
          <div ng-show="$root.searchMode" class="ng-cloak" ng-cloak>
            <span ng-cloak class="label ng-cloak report-label">
            <div ng-if="$root.reportMode">Reports&nbsp;</div>
            <div ng-if="$root.settingsMode">Setting&nbsp;</div>
            <div ng-if="$root.patientMode">Patients&nbsp;</div>
            <i ng-click="$ctrl.cancelSearchMode()" class="fa fa-times"></i></span>
          </div>
          <div ng-show="$root.reportTypeSet" class="ng-cloak" ng-cloak>
            <span ng-cloak class="label ng-cloak reportType-label">
            <div class="reportTypeSet">
              {{$root.reportTypeString}}&nbsp;
              <i ng-click="$ctrl.cancelReportType()" class="fa cancel-reportType fa-times"></i>
            </div>
            </span>
          </div>
          <div></div>
          <input key-bind="{ enter: '$ctrl.searchFunction()', esc: '$ctrl.cancelSearchMode()' }" class="form-control" placeholder="Search..." type="text" uib-typeahead="report for report in $ctrl.reportTypes | filter:$viewValue" ng-model="search.searchExpression" ng-keyup="$ctrl.checkExpression(search.searchExpression)" ng-trim="false" ng-class="{'moveRight': $root.searchMode && !$root.reportTypeSet, 'moveFurtherRight': $root.searchMode && $root.reportTypeSet}" focus-element="searchFocused"/>
        </div>
        <i ng-show="search.searchExpression !== '' || $root.searchMode" ng-click="$ctrl.cancelSearchMode()" class="clearAll fa fa-times-circle"></i>
        <button class="btn btn-info searchButton" ng-click="$ctrl.searchFunction();"><i class="fa fa-search"></i><span class="hidden-xs hidden-sm hidden-md"> Search</span></button>

      </div>

      <div class="advanced-search-text pull-right" ng-if="searchBar">
        <a ng-click="$ctrl.openAdvancedSearch()">Advanced search</a>
      </div>

    </div>

    <div class="col-md-3 col-sm-12 header-right">
      <!-- User Profile -->
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown-profile" uib-dropdown>
            <a href="#" class="dropdown-toggle" uib-dropdown-toggle>
              <span class="glyphicon glyphicon-user"></span>
              <span class="header-title-3">Demonstration</span>
              <span class="glyphicon glyphicon-chevron-down"></span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <div class="navbar-login">
                  <div class="row">
                    <div class="col-md-4 col-sm-4">
                      <div class="user-profile-image"><i class="glyphicon glyphicon-user"></i></div>
                    </div>
                    <div class="col-md-8 col-sm-8">
                      <p class="dropdown-profile-text"><b>{{user.given_name}} {{user.family_name}}</b></p>
                      <p class="dropdown-profile-text"><b>{{user.role}}</b></p>
                      <p class="dropdown-profile-text">{{user.email}}</p>
                      <p class="dropdown-profile-text">10/05/1984</p>
                    </div>
                  </div>
                </div>
              </li>
              <li class="divider"></li>
              <li>
                <div class="navbar-login navbar-login-session">
                  <div class="row">
                    <div class="col-lg-12">
                      <p>
                        <a class="btn btn-danger btn-block" ng-click="">Sign Out</a>
                      </p>
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <!-- /.User Profile -->
    </div>
  </div>
  <div class="row header-toolbar hidden-xs">
    <div class="col-sm-5 previousGroup">
    <!-- ngIf: previousPage && currentUser.role=='idcr' --> <!-- ngIf: previousPage && currentUser.role=='idcr' -->
    </div>
    <div class="col-sm-6">
      <span class="current-page-title ng-binding" ng-bind="pageHeader"></span>
    </div>
  </div>
</header>