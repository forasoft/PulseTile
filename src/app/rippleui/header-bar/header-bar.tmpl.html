<!--
  ~  Copyright 2016 Ripple Foundation C.I.C. Ltd
  ~  
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~  
  ~    http://www.apache.org/licenses/LICENSE-2.0

  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->
<header class="header">
  <nav class="navbar">
    <div class="header-navbar">
      <a ng-click="$ctrl.goHome()" class="btn-header btn-header-prev"><i class="fa fa-arrow-left"></i></a>
      <div class="wrap-logo">
        <a ng-if="title" class="logo" ng-click="$ctrl.goHome()">
          <img src="../../assets/images/ripple-icon.png" class="logo-icon" alt="{{$ctrl.title}}">
          <img src="../../assets/images/ripple-icon-mob.png" class="logo-icon-mob" alt="{{$ctrl.title}}">
        </a>
      </div>

      <ul class="user-panel" role="tablist">
        <li ng-class="$ctrl.activeNavTab('searchBar')" ng-if="searchBar" class="visible-xs"><a class="btn-header" ng-click="$ctrl.changeNavTab('searchBar')">
          <i class="fa fa-search"></i></a>
        </li>
        <li ng-class="$ctrl.activeNavTab('notifications')"><a class="btn-header" ng-click="$ctrl.changeNavTab('notifications')">
          <i class="fa fa-bell-o"><span class="count">2</span></i></a>
        </li>
        <li ng-class="stateName === 'profile' ? 'active' : ''"><a class="btn-header btn-user" ng-click="$ctrl.goProfile()">
          <i class="fa fa-user"></i></a>
        </li>
      </ul>

      <!-- Nav Search -->
      <div class="wrap-search wrap-header-search ng-cloak hidden-xs" ng-if="searchBar" ng-cloak ng-class="{'searchBarHidden' : !$ctrl.searchBarEnabled }">
        <div class="header-search">
          <button class="btn-header inverse btn-search" ng-click="$ctrl.searchFunction();"><i class="fa fa-search"></i></button>
          <div class="header-search-inner">
            <div ng-show="$root.searchMode" class="ng-cloak" ng-cloak>
              <span ng-cloak class="label ng-cloak report-label">
              <div ng-if="$root.reportMode">Reports&nbsp;</div>
              <div ng-if="$root.settingsMode">Setting&nbsp;</div>
              <div ng-if="$root.patientMode">Patients&nbsp;</div>
              <i ng-click="$ctrl.cancelSearchMode()" class="fa fa-times"></i></span>
            </div>
            <div ng-show="$root.reportTypeSet" class="ng-cloak" ng-cloak>
              <span ng-cloak class="label ng-cloak reportType-label">
              <div class="reportTypeSet">
                {{$root.reportTypeString}}&nbsp;
                <i ng-click="$ctrl.cancelReportType()" class="fa cancel-reportType fa-times"></i>
              </div>
              </span>
            </div>
            <div></div>
            <div class="holder">
              <input key-bind="{ enter: '$ctrl.searchFunction()', esc: '$ctrl.cancelSearchMode()' }" class="form-control" placeholder="Search" type="text" uib-typeahead="report for report in $ctrl.reportTypes | filter:$viewValue" ng-model="search.searchExpression" ng-keyup="$ctrl.checkExpression(search.searchExpression)" ng-trim="false" ng-class="{'moveRight': $root.searchMode && !$root.reportTypeSet, 'moveFurtherRight': $root.searchMode && $root.reportTypeSet}" focus-element="searchFocused"/>
              <i ng-show="search.searchExpression !== '' || $root.searchMode" ng-click="$ctrl.cancelSearchMode()" class="clearAll fa fa-times-circle"></i>
            </div>
          </div>
        </div>
        <!--  <div class="advanced-search-text pull-right" ng-if="searchBar">
          <a ng-click="$ctrl.openAdvancedSearch()">Advanced search</a>
        </div> -->
      </div>
      <!-- / Nav Search -->

      <!-- Nav Mobile Search -->
      <div class="wrap-search wrap-search-mobile clearfix ng-cloak" ng-if="searchBar && $ctrl.currentNavTab==='searchBar'" ng-cloak ng-class="{'searchBarHidden' : !$ctrl.searchBarEnabled }">
        <div class="header-search">
          <button class="btn-header secondary btn-search" ng-click="$ctrl.searchFunction();"><i class="fa fa-search"></i></button>
          <div class="header-search-inner">
            <div ng-show="$root.searchMode" class="ng-cloak" ng-cloak>
              <span ng-cloak class="label ng-cloak report-label">
              <div ng-if="$root.reportMode">Reports&nbsp;</div>
              <div ng-if="$root.settingsMode">Setting&nbsp;</div>
              <div ng-if="$root.patientMode">Patients&nbsp;</div>
              <i ng-click="$ctrl.cancelSearchMode()" class="fa fa-times"></i></span>
            </div>
            <div ng-show="$root.reportTypeSet" class="ng-cloak" ng-cloak>
              <span ng-cloak class="label ng-cloak reportType-label">
              <div class="reportTypeSet">
                {{$root.reportTypeString}}&nbsp;
                <i ng-click="$ctrl.cancelReportType()" class="fa cancel-reportType fa-times"></i>
              </div>
              </span>
            </div>
            <div></div>
            <div class="holder">
              <input key-bind="{ enter: '$ctrl.searchFunction()', esc: '$ctrl.cancelSearchMode()' }" class="form-control" placeholder="Search" type="text" uib-typeahead="report for report in $ctrl.reportTypes | filter:$viewValue" ng-model="search.searchExpression" ng-keyup="$ctrl.checkExpression(search.searchExpression)" ng-trim="false" ng-class="{'moveRight': $root.searchMode && !$root.reportTypeSet, 'moveFurtherRight': $root.searchMode && $root.reportTypeSet}" focus-element="searchFocused"/>
              <i ng-show="search.searchExpression !== '' || $root.searchMode" ng-click="$ctrl.cancelSearchMode()" class="clearAll fa fa-times-circle"></i>
            </div>
          </div>
        </div>
      </div>
      <!-- / Nav Mobile Search -->
    </div>

    <!-- Tab panes -->
    <div class="tab-content" ng-switch="currentNavTab">

      <!-- Notification -->
      <!-- <div ng-if="$ctrl.currentNavTab==='notifications'" class="pane row" id="tab-notifications">
        <div class="notifications-header">
          Notifications (2)
        </div>
        <div class="notifications-body">
          <ul>
            <li>
              <div class="notification-info">Information from Liquid Logic (Social Care) is currently unavailable.</div>
              <div class="notification-time">5 minutes ago</div>
            </li>
            <li>
              <div class="notification-info">Information from Liquid Logic (Social Care) is currently unavailable.</div>
              <div class="notification-time">5 minutes ago</div>
            </li>
          </ul>
        </div>
      </div> -->
      <!-- /.Notification -->

      <!-- User Profile -->
      <!-- <div ng-if="$ctrl.currentNavTab==='user'" class="pane row" id="tab-user">
        <div class="col-xs-12">

          <div class="user-type superuser">Super User</div>
          <div class="user-type clinician">Clinician</div>
          <div class="user-type patient">Patient</div>

          <div class="user-profile-image"><i class="fa fa-user"></i></div>
          <p class="header-title-mobile"><strong>User Name:</strong>{{$ctrl.user.given_name}} {{$ctrl.user.family_name}}</p>
          <p>{{$ctrl.user.role}}</p>
          <p>{{$ctrl.user.email}}</p>
          <p>10/05/2099</p>
        </div>
        <div class="col-xs-12 options">
          <ul>
            <li><a href="" class="btn">Settings</a></li>
            <li><a href="" class="btn">Admin Console</a></li>
          </ul>
          <ul>
            <li><a href="https://ripple-identity-uat.answerappcloud.com/signout" class="signout btn btn-danger">SIGN OUT  <i class="fa fa-sign-out"></i></a></li>
          </ul>
        </div>
      </div> -->
      <!-- /.User Profile -->
    </div>
    <!-- /.Tab panes -->
  </nav>

  <!-- Header title -->
  <div class="wrap-header-title" ng-if="isPageHeader">
    <div class="container-fluid">
      <div class="header-title">{{pageHeader}}</div>
    </div>
  </div>
  <!-- /.Header title -->

  <!-- Header toolbar -->
  <div class="wrap-header-toolbar" ng-if=userContextViewExists>
    <div class="container-fluid">
      <div class="header-toolbar">
        <button ng-click="$ctrl.clickSidebarBtn()" class="btn-toggle-sidebar wrap-icon" data-toggle="collapse" data-target="#sidebar-nav" aria-expanded="false">
          <i class="fa fa-bars"></i>
          <span>Menu</span>
        </button>
        <div ui-view="banner"></div>
      </div>
    </div>
  </div>
  <!-- /.Header toolbar-->
</header>