<!--
  ~  Copyright 2016 Ripple Foundation C.I.C. Ltd
  ~  
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~  
  ~    http://www.apache.org/licenses/LICENSE-2.0

  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->
<div class="transbox">
  <div class="innerTransbox">
    <h3><strong>Problem and Diagnosis</strong></h3>

    <div class="form-horizontal text-left">

      <div ng-if="!$ctrl.diagnosis.metaData">
        <div class="form-group">
          <label class="control-label col-md-3">Problem / Diagnosis:</label>
          <div class="col-md-9">
            <div class="form-control-static">{{ $ctrl.diagnosis.problem }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-md-12">Description:</label>
          <div class="col-md-12">
            <div class="form-control-static">{{ $ctrl.diagnosis.description }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-md-3">Date of Onset:</label>
          <div class="col-md-9">
            <div class="form-control-static">{{ $ctrl.diagnosis.dateOfOnset | date: 'dd-MMM-yyyy' }}</div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
            <span class="patientSummary-spinner" us-spinner="{radius:20, width:8, length: 16}" spinner-key="diagnosisDetail-spinner" spinner-start-active="true"></span>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-md-3">Terminology:</label>
          <div class="col-md-9">
            <div class="form-control-static">{{ $ctrl.diagnosis.terminology }}</div>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-md-3">Code:</label>
          <div class="col-md-9">
            <div class="form-control-static">{{ $ctrl.diagnosis.code }}</div>
          </div>
        </div>
      </div>

      <div ng-if="$ctrl.diagnosis.metaData">
        <div class="form-group" ng-repeat="(key, prop) in $ctrl.diagnosis.metaData track by key">
          <label class="control-label col-md-3">{{$ctrl.convertToLabel(key)}}</label>
          <div class="col-md-9">
            <div class="form-control-static">{{prop}}</div>
          </div>
        </div>
      </div>

    <div class="form-horizontal text-left">
      <div class="form-group">
        <label class="control-label col-md-3">Author:</label>
        <div class="col-md-9">
          <div class="form-control-static">{{ $ctrl.diagnosis.author }}</div>
        </div>
      </div>
    </div>

    <div class="form-horizontal text-left">
      <div class="form-group">
        <label class="control-label col-md-3">Date Created:</label>
        <div class="col-md-9">
          <div class="form-control-static">{{ $ctrl.diagnosis.dateCreated | date:'y-MM-dd'}}</div>
        </div>
      </div>
    </div>

      <div class="form-group">
        <label class="control-label col-md-3">Source:</label>
        <div class="col-md-9">
          <div class="form-control-static">{{$ctrl.diagnosis.source}}
            <div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
<div ng-if="diagnosis.source !== 'vista'" class="form-group text-right" ng-if="$ctrl.currentUser.permissions.indexOf('WRITE') !== -1">
  <button class="btn btn-info" ng-click="$ctrl.edit();"><i class="fa fa-pencil"></i> Edit</button>
</div>
